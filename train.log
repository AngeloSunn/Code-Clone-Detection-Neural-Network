nohup: ignoring input
training/training.py:145: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
Removed previous training artifacts at trained_models/codebert_bigclonebench_full_32_batch
CUDA available: True
bf16 available: True
  0%|          | 0/142377 [00:00<?, ?it/s]  0%|          | 1/142377 [00:02<114:39:11,  2.90s/it]  0%|          | 2/142377 [00:03<58:53:54,  1.49s/it]   0%|          | 3/142377 [00:03<41:12:11,  1.04s/it]  0%|          | 4/142377 [00:04<32:55:19,  1.20it/s]  0%|          | 5/142377 [00:04<28:15:12,  1.40it/s]  0%|          | 6/142377 [00:05<25:27:29,  1.55it/s]  0%|          | 7/142377 [00:05<23:43:00,  1.67it/s]  0%|          | 8/142377 [00:06<22:35:46,  1.75it/s]  0%|          | 9/142377 [00:06<21:49:34,  1.81it/s]  0%|          | 10/142377 [00:07<21:18:26,  1.86it/s]  0%|          | 11/142377 [00:07<20:55:51,  1.89it/s]  0%|          | 12/142377 [00:08<20:42:39,  1.91it/s]  0%|          | 13/142377 [00:09<20:36:52,  1.92it/s]  0%|          | 14/142377 [00:09<20:35:15,  1.92it/s]  0%|          | 15/142377 [00:10<20:21:36,  1.94it/s]  0%|          | 16/142377 [00:10<20:11:28,  1.96it/s]  0%|          | 17/142377 [00:11<20:07:16,  1.97it/s]  0%|          | 18/142377 [00:11<20:03:20,  1.97it/s]  0%|          | 19/142377 [00:12<20:01:25,  1.97it/s]  0%|          | 20/142377 [00:12<20:02:58,  1.97it/s]  0%|          | 21/142377 [00:13<19:58:52,  1.98it/s]  0%|          | 22/142377 [00:13<19:57:14,  1.98it/s]  0%|          | 23/142377 [00:14<19:59:05,  1.98it/s]  0%|          | 24/142377 [00:14<20:02:20,  1.97it/s]  0%|          | 25/142377 [00:15<20:04:24,  1.97it/s]  0%|          | 26/142377 [00:15<20:04:30,  1.97it/s]  0%|          | 27/142377 [00:16<20:08:29,  1.96it/s]  0%|          | 28/142377 [00:16<20:08:14,  1.96it/s]  0%|          | 29/142377 [00:17<20:09:57,  1.96it/s]  0%|          | 30/142377 [00:17<19:46:43,  2.00it/s]  0%|          | 31/142377 [00:18<19:56:28,  1.98it/s]  0%|          | 32/142377 [00:18<20:02:41,  1.97it/s]  0%|          | 33/142377 [00:19<20:06:16,  1.97it/s]  0%|          | 34/142377 [00:19<19:39:46,  2.01it/s]  0%|          | 35/142377 [00:20<19:50:32,  1.99it/s]  0%|          | 36/142377 [00:20<19:54:07,  1.99it/s]  0%|          | 37/142377 [00:21<20:00:25,  1.98it/s]  0%|          | 38/142377 [00:21<20:04:36,  1.97it/s]  0%|          | 39/142377 [00:22<20:09:21,  1.96it/s]  0%|          | 40/142377 [00:22<20:12:54,  1.96it/s]  0%|          | 41/142377 [00:23<20:15:16,  1.95it/s]  0%|          | 42/142377 [00:23<20:16:51,  1.95it/s]  0%|          | 43/142377 [00:24<20:18:37,  1.95it/s]  0%|          | 44/142377 [00:24<20:15:07,  1.95it/s]  0%|          | 45/142377 [00:25<20:16:25,  1.95it/s]  0%|          | 46/142377 [00:25<20:16:05,  1.95it/s]  0%|          | 47/142377 [00:26<20:14:04,  1.95it/s]  0%|          | 48/142377 [00:26<20:09:08,  1.96it/s]  0%|          | 49/142377 [00:27<20:03:03,  1.97it/s]  0%|          | 50/142377 [00:27<19:59:11,  1.98it/s]  0%|          | 51/142377 [00:28<19:55:53,  1.98it/s]  0%|          | 52/142377 [00:28<19:54:21,  1.99it/s]  0%|          | 53/142377 [00:29<19:53:40,  1.99it/s]  0%|          | 54/142377 [00:29<19:56:19,  1.98it/s]  0%|          | 55/142377 [00:30<19:58:14,  1.98it/s]  0%|          | 56/142377 [00:30<20:00:31,  1.98it/s]  0%|          | 57/142377 [00:31<19:54:41,  1.99it/s]  0%|          | 58/142377 [00:31<19:53:28,  1.99it/s]  0%|          | 59/142377 [00:32<19:53:05,  1.99it/s]  0%|          | 60/142377 [00:32<19:54:25,  1.99it/s]  0%|          | 61/142377 [00:33<19:55:08,  1.98it/s]  0%|          | 62/142377 [00:33<20:02:27,  1.97it/s]  0%|          | 63/142377 [00:34<20:00:34,  1.98it/s]  0%|          | 64/142377 [00:34<20:01:47,  1.97it/s]  0%|          | 65/142377 [00:35<20:06:22,  1.97it/s]  0%|          | 66/142377 [00:35<20:08:33,  1.96it/s]  0%|          | 67/142377 [00:36<20:13:36,  1.95it/s]  0%|          | 68/142377 [00:36<20:14:56,  1.95it/s]  0%|          | 69/142377 [00:37<20:13:13,  1.95it/s]  0%|          | 70/142377 [00:37<20:07:54,  1.96it/s]  0%|          | 71/142377 [00:38<20:08:20,  1.96it/s]  0%|          | 72/142377 [00:38<20:06:26,  1.97it/s]  0%|          | 73/142377 [00:39<20:04:49,  1.97it/s]  0%|          | 74/142377 [00:39<20:02:44,  1.97it/s]  0%|          | 75/142377 [00:40<20:02:18,  1.97it/s]  0%|          | 76/142377 [00:40<20:08:54,  1.96it/s]  0%|          | 77/142377 [00:41<20:03:28,  1.97it/s]  0%|          | 78/142377 [00:41<20:02:01,  1.97it/s]  0%|          | 79/142377 [00:42<20:00:56,  1.97it/s]  0%|          | 80/142377 [00:42<19:57:25,  1.98it/s]  0%|          | 81/142377 [00:43<20:02:16,  1.97it/s]  0%|          | 82/142377 [00:44<20:03:20,  1.97it/s]  0%|          | 83/142377 [00:44<20:00:08,  1.98it/s]  0%|          | 84/142377 [00:45<19:59:07,  1.98it/s]  0%|          | 85/142377 [00:45<20:00:02,  1.98it/s]  0%|          | 86/142377 [00:46<19:59:58,  1.98it/s]  0%|          | 87/142377 [00:46<20:00:29,  1.98it/s]  0%|          | 88/142377 [00:47<20:00:05,  1.98it/s]  0%|          | 89/142377 [00:47<19:58:57,  1.98it/s]  0%|          | 90/142377 [00:48<19:59:07,  1.98it/s]  0%|          | 91/142377 [00:48<20:03:23,  1.97it/s]  0%|          | 92/142377 [00:49<20:03:19,  1.97it/s]  0%|          | 93/142377 [00:49<20:05:19,  1.97it/s]  0%|          | 94/142377 [00:50<20:05:36,  1.97it/s]  0%|          | 95/142377 [00:50<20:05:47,  1.97it/s]  0%|          | 96/142377 [00:51<20:16:08,  1.95it/s]  0%|          | 97/142377 [00:51<20:13:22,  1.95it/s]  0%|          | 98/142377 [00:52<20:11:07,  1.96it/s]  0%|          | 99/142377 [00:52<20:05:31,  1.97it/s]  0%|          | 100/142377 [00:53<20:06:05,  1.97it/s]                                                         0%|          | 100/142377 [00:53<20:06:05,  1.97it/s]  0%|          | 101/142377 [00:53<20:14:36,  1.95it/s]  0%|          | 102/142377 [00:54<20:12:50,  1.96it/s]  0%|          | 103/142377 [00:54<20:11:11,  1.96it/s]  0%|          | 104/142377 [00:55<20:10:11,  1.96it/s]  0%|          | 105/142377 [00:55<20:07:12,  1.96it/s]  0%|          | 106/142377 [00:56<19:40:19,  2.01it/s]  0%|          | 107/142377 [00:56<19:51:28,  1.99it/s]  0%|          | 108/142377 [00:57<20:03:43,  1.97it/s]  0%|          | 109/142377 [00:57<20:13:18,  1.95it/s]  0%|          | 110/142377 [00:58<20:18:43,  1.95it/s]  0%|          | 111/142377 [00:58<20:25:06,  1.94it/s]  0%|          | 112/142377 [00:59<20:26:19,  1.93it/s]  0%|          | 113/142377 [00:59<20:18:50,  1.95it/s]  0%|          | 114/142377 [01:00<20:17:24,  1.95it/s]  0%|          | 115/142377 [01:00<20:20:52,  1.94it/s]  0%|          | 116/142377 [01:01<20:19:53,  1.94it/s]  0%|          | 117/142377 [01:01<20:16:05,  1.95it/s]  0%|          | 118/142377 [01:02<20:19:07,  1.94it/s]  0%|          | 119/142377 [01:02<20:21:07,  1.94it/s]  0%|          | 120/142377 [01:03<20:22:04,  1.94it/s]  0%|          | 121/142377 [01:03<20:18:14,  1.95it/s]  0%|          | 122/142377 [01:04<20:10:55,  1.96it/s]  0%|          | 123/142377 [01:04<20:13:43,  1.95it/s]  0%|          | 124/142377 [01:05<20:09:49,  1.96it/s]  0%|          | 125/142377 [01:05<20:21:20,  1.94it/s]  0%|          | 126/142377 [01:06<20:22:53,  1.94it/s]  0%|          | 127/142377 [01:06<20:18:38,  1.95it/s]  0%|          | 128/142377 [01:07<20:17:53,  1.95it/s]  0%|          | 129/142377 [01:08<24:17:38,  1.63it/s]  0%|          | 130/142377 [01:08<23:00:55,  1.72it/s]  0%|          | 131/142377 [01:09<22:07:28,  1.79it/s]  0%|          | 132/142377 [01:09<21:37:01,  1.83it/s]  0%|          | 133/142377 [01:10<21:09:09,  1.87it/s]  0%|          | 134/142377 [01:10<20:51:10,  1.89it/s]  0%|          | 135/142377 [01:11<20:40:13,  1.91it/s]  0%|          | 136/142377 [01:11<20:27:28,  1.93it/s]  0%|          | 137/142377 [01:12<20:23:25,  1.94it/s]  0%|          | 138/142377 [01:12<20:21:23,  1.94it/s]  0%|          | 139/142377 [01:13<20:13:53,  1.95it/s]  0%|          | 140/142377 [01:13<20:08:20,  1.96it/s]  0%|          | 141/142377 [01:14<20:10:15,  1.96it/s]  0%|          | 142/142377 [01:14<20:07:07,  1.96it/s]  0%|          | 143/142377 [01:15<20:04:03,  1.97it/s]  0%|          | 144/142377 [01:15<20:06:01,  1.97it/s]  0%|          | 145/142377 [01:16<20:03:47,  1.97it/s]  0%|          | 146/142377 [01:17<20:07:54,  1.96it/s]  0%|          | 147/142377 [01:17<20:15:28,  1.95it/s]  0%|          | 148/142377 [01:18<20:13:10,  1.95it/s]  0%|          | 149/142377 [01:18<20:11:27,  1.96it/s]  0%|          | 150/142377 [01:19<20:12:42,  1.95it/s]  0%|          | 151/142377 [01:19<20:17:36,  1.95it/s]  0%|          | 152/142377 [01:20<20:19:34,  1.94it/s]  0%|          | 153/142377 [01:20<20:21:31,  1.94it/s]  0%|          | 154/142377 [01:21<20:22:24,  1.94it/s]  0%|          | 155/142377 [01:21<20:17:34,  1.95it/s]  0%|          | 156/142377 [01:22<20:16:38,  1.95it/s]  0%|          | 157/142377 [01:22<20:15:56,  1.95it/s]  0%|          | 158/142377 [01:23<20:19:20,  1.94it/s]  0%|          | 159/142377 [01:23<20:22:23,  1.94it/s]  0%|          | 160/142377 [01:24<20:27:47,  1.93it/s]  0%|          | 161/142377 [01:24<20:32:59,  1.92it/s]  0%|          | 162/142377 [01:25<20:38:55,  1.91it/s]  0%|          | 163/142377 [01:25<20:33:38,  1.92it/s]  0%|          | 164/142377 [01:26<20:31:03,  1.93it/s]  0%|          | 165/142377 [01:26<20:28:11,  1.93it/s]  0%|          | 166/142377 [01:27<20:31:02,  1.93it/s]  0%|          | 167/142377 [01:27<20:28:33,  1.93it/s]  0%|          | 168/142377 [01:28<20:27:39,  1.93it/s]  0%|          | 169/142377 [01:28<20:32:43,  1.92it/s]  0%|          | 170/142377 [01:29<20:34:11,  1.92it/s]  0%|          | 171/142377 [01:29<20:38:28,  1.91it/s]  0%|          | 172/142377 [01:30<20:41:40,  1.91it/s]  0%|          | 173/142377 [01:30<20:38:41,  1.91it/s]  0%|          | 174/142377 [01:31<20:32:49,  1.92it/s]  0%|          | 175/142377 [01:32<20:30:11,  1.93it/s]  0%|          | 176/142377 [01:32<20:30:05,  1.93it/s]  0%|          | 177/142377 [01:33<20:33:33,  1.92it/s]  0%|          | 178/142377 [01:33<20:27:59,  1.93it/s]  0%|          | 179/142377 [01:34<20:24:36,  1.94it/s]  0%|          | 180/142377 [01:34<20:20:24,  1.94it/s]  0%|          | 181/142377 [01:35<20:19:17,  1.94it/s]  0%|          | 182/142377 [01:35<20:17:26,  1.95it/s]  0%|          | 183/142377 [01:36<20:16:04,  1.95it/s]  0%|          | 184/142377 [01:36<20:18:43,  1.94it/s]  0%|          | 185/142377 [01:37<20:14:36,  1.95it/s]  0%|          | 186/142377 [01:37<20:21:46,  1.94it/s]  0%|          | 187/142377 [01:38<20:19:41,  1.94it/s]  0%|          | 188/142377 [01:38<20:17:47,  1.95it/s]  0%|          | 189/142377 [01:39<20:30:18,  1.93it/s]  0%|          | 190/142377 [01:39<20:24:40,  1.94it/s]  0%|          | 191/142377 [01:40<20:28:29,  1.93it/s]  0%|          | 192/142377 [01:40<20:25:40,  1.93it/s]  0%|          | 193/142377 [01:41<20:24:15,  1.94it/s]  0%|          | 194/142377 [01:41<20:21:40,  1.94it/s]  0%|          | 195/142377 [01:42<20:21:40,  1.94it/s]  0%|          | 196/142377 [01:42<20:20:59,  1.94it/s]  0%|          | 197/142377 [01:43<20:31:16,  1.92it/s]  0%|          | 198/142377 [01:43<20:24:08,  1.94it/s]  0%|          | 199/142377 [01:44<20:22:05,  1.94it/s]  0%|          | 200/142377 [01:44<20:25:42,  1.93it/s]                                                         0%|          | 200/142377 [01:44<20:25:42,  1.93it/s]  0%|          | 201/142377 [01:45<20:31:34,  1.92it/s]  0%|          | 202/142377 [01:45<20:28:01,  1.93it/s]  0%|          | 203/142377 [01:46<20:26:29,  1.93it/s]  0%|          | 204/142377 [01:46<20:22:28,  1.94it/s]  0%|          | 205/142377 [01:47<20:32:18,  1.92it/s]  0%|          | 206/142377 [01:48<20:29:04,  1.93it/s]  0%|          | 207/142377 [01:48<20:23:45,  1.94it/s]  0%|          | 208/142377 [01:49<20:16:48,  1.95it/s]  0%|          | 209/142377 [01:49<20:16:14,  1.95it/s]  0%|          | 210/142377 [01:50<20:13:07,  1.95it/s]  0%|          | 211/142377 [01:50<20:17:47,  1.95it/s]  0%|          | 212/142377 [01:51<20:21:49,  1.94it/s]  0%|          | 213/142377 [01:51<20:22:34,  1.94it/s]  0%|          | 214/142377 [01:52<20:25:00,  1.93it/s]  0%|          | 215/142377 [01:52<20:24:33,  1.93it/s]  0%|          | 216/142377 [01:53<20:25:25,  1.93it/s]  0%|          | 217/142377 [01:53<20:28:30,  1.93it/s]  0%|          | 218/142377 [01:54<20:01:13,  1.97it/s]  0%|          | 219/142377 [01:54<20:12:10,  1.95it/s]  0%|          | 220/142377 [01:55<20:26:45,  1.93it/s]  0%|          | 221/142377 [01:55<20:42:38,  1.91it/s]  0%|          | 222/142377 [01:56<20:52:52,  1.89it/s]  0%|          | 223/142377 [01:56<20:59:29,  1.88it/s]  0%|          | 224/142377 [01:57<21:03:59,  1.87it/s]  0%|          | 225/142377 [01:57<21:08:02,  1.87it/s]  0%|          | 226/142377 [01:58<21:10:18,  1.87it/s]  0%|          | 227/142377 [01:59<21:03:01,  1.88it/s]  0%|          | 228/142377 [01:59<20:32:12,  1.92it/s]  0%|          | 229/142377 [02:00<20:37:41,  1.91it/s]  0%|          | 230/142377 [02:00<20:41:22,  1.91it/s]  0%|          | 231/142377 [02:01<20:48:21,  1.90it/s]  0%|          | 232/142377 [02:01<20:56:56,  1.88it/s]  0%|          | 233/142377 [02:02<20:56:32,  1.89it/s]  0%|          | 234/142377 [02:02<20:51:35,  1.89it/s]  0%|          | 235/142377 [02:03<20:49:28,  1.90it/s]  0%|          | 236/142377 [02:03<20:48:58,  1.90it/s]  0%|          | 237/142377 [02:04<20:50:07,  1.90it/s]  0%|          | 238/142377 [02:04<20:53:11,  1.89it/s]  0%|          | 239/142377 [02:05<20:55:45,  1.89it/s]  0%|          | 240/142377 [02:05<20:56:57,  1.88it/s]  0%|          | 241/142377 [02:06<20:57:07,  1.88it/s]  0%|          | 242/142377 [02:06<20:59:07,  1.88it/s]  0%|          | 243/142377 [02:07<20:56:09,  1.89it/s]  0%|          | 244/142377 [02:07<20:54:56,  1.89it/s]  0%|          | 245/142377 [02:08<20:36:38,  1.92it/s]  0%|          | 246/142377 [02:08<20:28:57,  1.93it/s]  0%|          | 247/142377 [02:09<20:23:33,  1.94it/s]  0%|          | 248/142377 [02:10<20:19:45,  1.94it/s]  0%|          | 249/142377 [02:10<20:19:41,  1.94it/s]  0%|          | 250/142377 [02:11<20:25:13,  1.93it/s]{'loss': 0.7033, 'grad_norm': 2.2772631645202637, 'learning_rate': 2.0000000000000003e-06, 'epoch': 0.0}
{'loss': 0.6705, 'grad_norm': 8.049917221069336, 'learning_rate': 4.000000000000001e-06, 'epoch': 0.0}
Traceback (most recent call last):
  File "training/training.py", line 188, in <module>
    main()
  File "training/training.py", line 164, in main
    trainer.train()
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/transformers/trainer.py", line 2123, in train
    return inner_training_loop(
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/transformers/trainer.py", line 2548, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/transformers/trainer.py", line 3004, in _maybe_log_save_evaluate
    metrics = self._evaluate(trial, ignore_keys_for_eval)
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/transformers/trainer.py", line 2958, in _evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/transformers/trainer.py", line 3975, in evaluate
    output = eval_loop(
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/transformers/trainer.py", line 4159, in evaluation_loop
    for step, inputs in enumerate(dataloader):
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/accelerate/data_loader.py", line 550, in __iter__
    current_batch = next(dataloader_iter)
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1344, in _next_data
    return self._process_data(data)
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1370, in _process_data
    data.reraise()
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/torch/_utils.py", line 706, in reraise
    raise exception
KeyError: Caught KeyError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 2606, in pandas._libs.hashtable.Int64HashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 2630, in pandas._libs.hashtable.Int64HashTable.get_item
KeyError: 8

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 309, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/training/dataset.py", line 52, in __getitem__
    label = int(row[self.label_col])
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/pandas/core/series.py", line 1007, in __getitem__
    return self._get_value(key)
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/pandas/core/series.py", line 1116, in _get_value
    loc = self.index.get_loc(label)
  File "/home/wieden/dev/Code-Clone-Detection-Neural-Network/.venv/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 8

  0%|          | 250/142377 [02:12<20:59:45,  1.88it/s]